<?php
if (!defined('ABSPATH')) {
    exit;
}

// Add SVG support
add_filter('wp_kses_allowed_html', 'lapinopay_allow_svg_tags', 10, 2);
function lapinopay_allow_svg_tags($allowed_tags, $context)
{
    if ($context === 'post') {
        $allowed_tags['svg'] = array(
            'xmlns' => true,
            'width' => true,
            'height' => true,
            'viewbox' => true,
            'fill' => true,
            'class' => true,
        );
        $allowed_tags['path'] = array(
            'd' => true,
            'fill' => true,
            'stroke' => true,
            'stroke-width' => true,
            'stroke-linecap' => true,
            'stroke-linejoin' => true,
        );
    }
    return $allowed_tags;
}

// Add this helper function
function lapinopay_get_payment_icon($icon_name, $alt_text)
{
    if ($icon_name === 'shield-check') {
        $icon_url = plugins_url('assets/icons/secure-payment.png', dirname(__FILE__));
        return sprintf(
            '<div class="lapinopay-payment-icon" role="img" aria-label="%s">
                <img src="%s" alt="%s" width="50" style="display: block;">
            </div>',
            esc_attr($alt_text),
            esc_url($icon_url),
            esc_attr($alt_text)
        );
    }
    $svg_icons = array(
        'shield-check' => '<svg width="46" height="38" viewBox="0 0 46 38" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M43 1H7C5.89543 1 5 1.89543 5 3V27C5 28.1046 5.89543 29 7 29H43C44.1046 29 45 28.1046 45 27V3C45 1.89543 44.1046 1 43 1Z" fill="#4AC6B7"/>
            <path d="M43 1H40C40.5304 1 41.0391 1.21071 41.4142 1.58579C41.7893 1.96086 42 2.46957 42 3V27C42 27.5304 41.7893 28.0391 41.4142 28.4142C41.0391 28.7893 40.5304 29 40 29H43C43.5304 29 44.0391 28.7893 44.4142 28.4142C44.7893 28.0391 45 27.5304 45 27V3C45 2.46957 44.7893 1.96086 44.4142 1.58579C44.0391 1.21071 43.5304 1 43 1Z" fill="#37B7A4"/>
            <path d="M45 6H5V13H45V6Z" fill="#29A892"/>
            <path d="M45 6H42V13H45V6Z" fill="#1B967E"/>
            <path d="M37 24C38.6569 24 40 22.6569 40 21C40 19.3431 38.6569 18 37 18C35.3431 18 34 19.3431 34 21C34 22.6569 35.3431 24 37 24Z" fill="#FFBC5A"/>
            <path d="M32 24C33.6569 24 35 22.6569 35 21C35 19.3431 33.6569 18 32 18C30.3431 18 29 19.3431 29 21C29 22.6569 30.3431 24 32 24Z" fill="#E05555"/>
            <path d="M9.0026 37C7.2453 36.3561 1 33.675 1 28.0863V19.9423L9 17L17 19.9423V28.0864C17 33.7024 10.763 36.3618 9.0026 37Z" fill="#D3DBEF"/>
            <path d="M8.99943 29C8.86811 29.0001 8.73807 28.9742 8.61675 28.9239C8.49543 28.8736 8.38522 28.7999 8.29243 28.707L6.29243 26.707C6.11027 26.5184 6.00948 26.2658 6.01176 26.0036C6.01403 25.7414 6.1192 25.4906 6.30461 25.3052C6.49002 25.1198 6.74083 25.0146 7.00303 25.0123C7.26523 25.0101 7.51783 25.1108 7.70643 25.293L8.89103 26.4776L11.1994 23.4C11.3586 23.1878 11.5955 23.0476 11.858 23.0101C12.1206 22.9725 12.3873 23.0409 12.5994 23.2C12.8116 23.3591 12.9519 23.596 12.9894 23.8586C13.0269 24.1211 12.9586 24.3878 12.7994 24.6L9.79943 28.6C9.71358 28.7147 9.60403 28.8096 9.47824 28.8782C9.35244 28.9468 9.21336 28.9875 9.07043 28.9975C9.04683 28.999 9.02283 29 8.99943 29Z" fill="#8491C1"/>
            <path d="M43 0H7C6.20462 0.000873479 5.44206 0.317225 4.87964 0.879644C4.31722 1.44206 4.00087 2.20462 4 3V17.7736L0.6548 19.0036C0.462694 19.0743 0.296898 19.2022 0.179801 19.3701C0.062703 19.5379 -5.54009e-05 19.7377 3.66964e-08 19.9424V28.086C3.66964e-08 34.286 6.6274 37.1954 8.6587 37.9395C8.76891 37.9794 8.8852 37.9999 9.0024 38C9.11863 38 9.23397 37.9797 9.3432 37.94C11.1524 37.2831 16.5966 34.9124 17.7656 30H43C43.7954 29.9991 44.5579 29.6828 45.1204 29.1204C45.6828 28.5579 45.9991 27.7954 46 27V3C45.9991 2.20462 45.6828 1.44206 45.1204 0.879644C44.5579 0.317225 43.7954 0.000873479 43 0ZM6 7H44V12H6V7ZM9.0039 35.9307C6.9814 35.1348 2 32.7012 2 28.0859V20.64L9 18.0658L16 20.64V28.0863C16 32.7246 11.0249 35.1416 9.0039 35.9307ZM44 27C43.9997 27.2651 43.8943 27.5193 43.7068 27.7068C43.5193 27.8943 43.2651 27.9997 43 28H18V19.9424C18 19.7378 17.9372 19.5381 17.8201 19.3702C17.703 19.2024 17.5373 19.0745 17.3452 19.0039L9.3452 16.0615C9.12249 15.9796 8.8779 15.9796 8.6552 16.0615L6 17.038V14H44V27ZM6 5V3C6.00026 2.73486 6.10571 2.48066 6.29319 2.29319C6.48066 2.10571 6.73486 2.00026 7 2H43C43.2651 2.00026 43.5193 2.10571 43.7068 2.29319C43.8943 2.48066 43.9997 2.73486 44 3V5H6Z" fill="#231F20"/>
            <path d="M32 25C32.908 24.9961 33.7871 24.6804 34.49 24.1057C35.0769 24.5821 35.7867 24.8824 36.5373 24.9719C37.2878 25.0614 38.0484 24.9364 38.7308 24.6113C39.4132 24.2863 39.9896 23.7746 40.3931 23.1354C40.7967 22.4963 41.0108 21.7559 41.0108 21C41.0108 20.2441 40.7967 19.5037 40.3931 18.8646C39.9896 18.2254 39.4132 17.7137 38.7308 17.3887C38.0484 17.0637 37.2878 16.9386 36.5373 17.0281C35.7867 17.1176 35.0769 17.4179 34.49 17.8943C33.7871 17.3196 32.908 17.0039 32 17C30.9391 17 29.9217 17.4214 29.1716 18.1716C28.4214 18.9217 28 19.9391 28 21C28 22.0609 28.4214 23.0783 29.1716 23.8284C29.9217 24.5786 30.9391 25 32 25ZM39 21C38.9994 21.5302 38.7885 22.0386 38.4135 22.4135C38.0386 22.7885 37.5302 22.9994 37 23C36.5214 23.0018 36.0586 22.8291 35.6981 22.5142C35.8974 22.0343 36 21.5197 36 21.0001C36 20.4804 35.8974 19.9658 35.6981 19.4859C36.0586 19.171 36.5214 18.9983 37 19C37.5302 19.0006 38.0386 19.2115 38.4135 19.5865C38.7885 19.9614 38.9994 20.4698 39 21ZM32 19C32.3956 19 32.7822 19.1173 33.1111 19.3371C33.44 19.5568 33.6964 19.8692 33.8478 20.2346C33.9991 20.6001 34.0387 21.0022 33.9616 21.3902C33.8844 21.7781 33.6939 22.1345 33.4142 22.4142C33.1345 22.6939 32.7781 22.8844 32.3902 22.9616C32.0022 23.0387 31.6001 22.9991 31.2346 22.8478C30.8692 22.6964 30.5568 22.44 30.3371 22.1111C30.1173 21.7822 30 21.3956 30 21C30.0006 20.4698 30.2115 19.9614 30.5865 19.5865C30.9614 19.2115 31.4698 19.0006 32 19Z" fill="#231F20"/>
            <path d="M11.1994 23.4L8.89103 26.4775L7.70643 25.293C7.51783 25.1108 7.26523 25.0101 7.00303 25.0123C6.74083 25.0146 6.49002 25.1198 6.30461 25.3052C6.1192 25.4906 6.01403 25.7414 6.01176 26.0036C6.00948 26.2658 6.11027 26.5184 6.29243 26.707L8.29243 28.707C8.38522 28.7999 8.49543 28.8736 8.61675 28.9239C8.73807 28.9742 8.86811 29.0001 8.99943 29C9.02283 29 9.04683 28.999 9.07023 28.9971C9.21316 28.9871 9.35227 28.9465 9.47809 28.878C9.60392 28.8095 9.71352 28.7147 9.79943 28.6L12.7994 24.6C12.9586 24.3878 13.0269 24.1211 12.9894 23.8586C12.9519 23.596 12.8116 23.3591 12.5994 23.2C12.3873 23.0409 12.1206 22.9725 11.858 23.0101C11.5955 23.0476 11.3586 23.1878 11.1994 23.4Z" fill="#231F20"/>
            </svg>
        ',
        'credit-card' => '<svg width="46" height="33" viewBox="0 0 46 33" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M46 31.0345C46 31.4154 45.8486 31.7808 45.5793 32.0502C45.3099 32.3195 44.9445 32.4709 44.5636 32.4709H1.47151C1.09066 32.4709 0.725272 32.3195 0.455842 32.0502C0.186577 31.7808 0.0351562 31.4154 0.0351562 31.0345V2.30794C0.0351562 1.92691 0.186577 1.56153 0.455842 1.29227C0.725272 1.02284 1.09066 0.871582 1.47151 0.871582H44.5636C44.9445 0.871582 45.3099 1.02284 45.5793 1.29227C45.8486 1.56153 46 1.92691 46 2.30794V31.0345Z" fill="#F3B607"/>
            <path d="M1.47151 0.871582C1.09066 0.871582 0.725272 1.02284 0.455842 1.29227C0.186577 1.56153 0.0351562 1.92691 0.0351562 2.30794V31.0345C0.0351562 31.4159 0.186742 31.7605 0.429508 32.0185L31.5779 0.871582H1.47151Z" fill="#FACB1B"/>
            <path d="M41.6949 13.7988C41.6949 14.1797 41.5435 14.545 41.2741 14.8145C41.0048 15.0837 40.6394 15.2352 40.2584 15.2352H32.3582C31.9774 15.2352 31.612 15.0837 31.3426 14.8145C31.0733 14.545 30.9219 14.1797 30.9219 13.7988V8.05338C30.9219 7.67252 31.0733 7.30714 31.3426 7.03787C31.612 6.76844 31.9774 6.61719 32.3582 6.61719H40.2584C40.6394 6.61719 41.0048 6.76844 41.2741 7.03787C41.5435 7.30714 41.6949 7.67252 41.6949 8.05338V13.7988Z" fill="#FBEC9A"/>
            <path d="M15.884 16.6707C15.1775 16.6712 14.479 16.5204 13.8352 16.2288C13.1915 15.9371 12.6178 15.5112 12.1523 14.9794C12.9522 14.0722 13.3945 12.9048 13.3963 11.6952C13.3945 10.4858 12.9522 9.31824 12.1523 8.41103C12.6178 7.87941 13.1917 7.45346 13.8352 7.16181C14.479 6.87016 15.1775 6.7194 15.884 6.71973C16.5376 6.71956 17.1849 6.84811 17.7888 7.09811C18.3925 7.34829 18.9412 7.71466 19.4034 8.17682C19.8656 8.63898 20.2321 9.18755 20.4821 9.79142C20.7321 10.3953 20.8607 11.0425 20.8605 11.696C20.8607 12.3494 20.732 12.9964 20.482 13.6001C20.2318 14.2039 19.8652 14.7524 19.4031 15.2144C18.9409 15.6764 18.3924 16.0428 17.7885 16.2926C17.1848 16.5425 16.5376 16.671 15.884 16.6707Z" fill="#FBE158"/>
            <path d="M12.1579 14.9793C11.3581 14.0723 10.9159 12.9049 10.9141 11.6955C10.9159 10.4861 11.3581 9.31883 12.1579 8.41162C12.9577 9.31883 13.4 10.4861 13.4018 11.6955C13.3998 12.9049 12.9577 14.0723 12.1579 14.9793Z" fill="#F99134"/>
            <path d="M8.42552 16.6715C7.77195 16.6717 7.12479 16.5431 6.52092 16.2931C5.91704 16.0431 5.36847 15.6766 4.90631 15.2144C4.44415 14.7523 4.07761 14.2037 3.82761 13.5998C3.5776 12.9961 3.44905 12.349 3.44922 11.6954C3.44905 11.0418 3.5776 10.3946 3.82761 9.79077C4.07761 9.18707 4.44415 8.63833 4.90631 8.17617C5.36847 7.71417 5.91704 7.34764 6.52092 7.09763C7.12479 6.84762 7.77195 6.71891 8.42552 6.71924C9.13226 6.71875 9.83077 6.86935 10.4745 7.16116C11.118 7.45281 11.6919 7.87876 12.1574 8.41054C11.3575 9.31775 10.9152 10.4852 10.9134 11.6946C10.9152 12.9041 11.3575 14.0715 12.1574 14.9787C11.6921 15.5108 11.1183 15.9373 10.4748 16.2293C9.8311 16.5211 9.13243 16.672 8.42552 16.6715Z" fill="#FA5655"/>
            <path d="M5.07631 28.5956V28.0179C5.07631 27.9344 5.11367 27.8749 5.21918 27.8749C5.32484 27.8749 5.3622 27.9344 5.3622 28.0179V28.7386C5.3622 28.8421 5.29324 28.8816 5.21918 28.8816H4.09208C4.01736 28.8816 3.94922 28.8415 3.94922 28.7386C3.94922 28.6359 4.01818 28.5956 4.09208 28.5956H4.51227V26.9413H4.09208C4.01736 26.9413 3.94922 26.901 3.94922 26.7983C3.94922 26.6956 4.01818 26.6553 4.09208 26.6553H4.79833V28.5956H5.07631Z" fill="#3E3E3F"/>
            <path d="M6.29436 28.5956H7.27859C7.35331 28.5956 7.42145 28.6359 7.42145 28.7386C7.42145 28.8421 7.35249 28.8816 7.27859 28.8816H6.00781V27.9489C6.00781 27.734 6.11628 27.6255 6.33106 27.6255H7.13491V26.9413H6.15067C6.07595 26.9413 6.00781 26.901 6.00781 26.7983C6.00781 26.6956 6.07677 26.6553 6.15067 26.6553H7.10034C7.19515 26.6553 7.26065 26.6696 7.33241 26.7358C7.4129 26.8105 7.42145 26.8873 7.42145 26.9902V27.5766C7.42145 27.6793 7.4129 27.757 7.33241 27.8309C7.26065 27.8964 7.19515 27.9107 7.10034 27.9107H6.2937L6.29436 28.5956Z" fill="#3E3E3F"/>
            <path d="M8.20943 26.9404C8.13471 26.9404 8.06641 26.9002 8.06641 26.7974C8.06641 26.6947 8.13537 26.6543 8.20943 26.6543H9.19366C9.23136 26.6537 9.26888 26.6604 9.30394 26.6746C9.339 26.6887 9.37076 26.7098 9.39742 26.7365C9.42425 26.7631 9.44532 26.7951 9.45931 26.8301C9.47346 26.8652 9.48021 26.9027 9.47955 26.9404V27.4903C9.47955 27.6045 9.45651 27.6878 9.36747 27.7676C9.45651 27.8481 9.47955 27.9307 9.47955 28.0449V28.5948C9.48021 28.6325 9.47346 28.67 9.45931 28.7051C9.44532 28.7402 9.42425 28.7721 9.39742 28.7987C9.37076 28.8256 9.339 28.8465 9.30394 28.8606C9.26888 28.8748 9.23136 28.8815 9.19366 28.8809H8.20943C8.13471 28.8809 8.06641 28.8406 8.06641 28.7379C8.06641 28.635 8.13537 28.5948 8.20943 28.5948H9.19366V28.119C9.19366 27.9589 9.13112 27.91 9.05064 27.91H8.48956C8.41484 27.91 8.34653 27.8697 8.34653 27.767C8.34653 27.6641 8.41484 27.6239 8.48956 27.6239H9.05064C9.1303 27.6239 9.19366 27.5757 9.19366 27.4147V26.9404H8.20943Z" fill="#3E3E3F"/>
            <path d="M11.1107 27.8676V27.0404C11.1107 26.9687 11.1453 26.8974 11.2538 26.8974C11.3622 26.8974 11.3968 26.9693 11.3968 27.0404V27.8676C11.4715 27.8676 11.5397 27.908 11.5397 28.0107C11.5397 28.1134 11.4707 28.1537 11.3968 28.1537V28.7372C11.3968 28.8285 11.3565 28.8802 11.2538 28.8802C11.1511 28.8802 11.1107 28.8285 11.1107 28.7372V28.1537H10.2695V26.7968C10.2695 26.7249 10.3041 26.6538 10.4126 26.6538C10.521 26.6538 10.5554 26.7257 10.5554 26.7968V27.8676H11.1107Z" fill="#3E3E3F"/>
            <path d="M14.8112 27.624H15.3377C15.429 27.624 15.498 27.6384 15.567 27.7045C15.6466 27.7793 15.6552 27.8476 15.6552 27.9475V28.5604C15.6552 28.6488 15.6466 28.7121 15.5862 28.7839C15.5151 28.8695 15.4404 28.881 15.3377 28.881H14.7027C14.628 28.881 14.5855 28.8609 14.5138 28.8292L14.4053 28.7811C14.3284 28.7465 14.2422 28.7207 14.2422 28.6208C14.2422 28.5461 14.3047 28.4778 14.3795 28.4778C14.4139 28.4778 14.4397 28.4865 14.4713 28.5008L14.5569 28.5382C14.597 28.5555 14.6624 28.5956 14.7085 28.5956H15.3693V27.9108H14.5253V26.6538H15.5123C15.587 26.6538 15.6552 26.6941 15.6552 26.7968C15.6552 26.9004 15.5862 26.9399 15.5123 26.9399H14.8112V27.624Z" fill="#3E3E3F"/>
            <path d="M16.5873 27.8683H17.5429C17.6858 27.8683 17.7146 27.928 17.7146 28.0602V28.7013C17.7146 28.8357 17.6571 28.8816 17.5284 28.8816H16.4868C16.3525 28.8816 16.3008 28.8328 16.3008 28.7013V26.7983C16.3008 26.733 16.3237 26.6553 16.4236 26.6553H16.5952C16.67 26.6553 16.7304 26.7242 16.7304 26.7983C16.7313 26.8174 16.7282 26.8363 16.7213 26.8541C16.7146 26.8719 16.704 26.888 16.6905 26.9015C16.677 26.915 16.6609 26.9254 16.6431 26.9323C16.6253 26.9392 16.6064 26.9421 16.5873 26.9413V27.8683ZM16.5873 28.1543V28.5949H17.4287V28.1543H16.5873Z" fill="#3E3E3F"/>
            <path d="M18.6459 26.9413C18.6459 27.0039 18.5942 27.0844 18.5031 27.0844C18.4652 27.0837 18.429 27.0686 18.4023 27.0419C18.3755 27.0152 18.36 26.9792 18.3594 26.9413V26.7983C18.3594 26.7358 18.4111 26.6553 18.5022 26.6553H19.7724V27.4853C19.7724 27.5852 19.7753 27.5967 19.6955 27.6657L19.2947 28.0121C19.22 28.0775 19.2149 28.0832 19.2149 28.1838V28.7386C19.2149 28.83 19.1747 28.8816 19.072 28.8816C18.9692 28.8816 18.929 28.83 18.929 28.7386V28.0495C18.929 27.9545 18.9318 27.946 19.0037 27.8834L19.3989 27.5429C19.4929 27.4594 19.4871 27.4631 19.4871 27.3365V26.9413H18.6459Z" fill="#3E3E3F"/>
            <path d="M21.3976 26.6538C21.4946 26.6538 21.5405 26.7228 21.5405 26.7968V27.624C21.6182 27.6222 21.6932 27.6512 21.7497 27.7045C21.8014 27.7526 21.8272 27.8245 21.8272 27.9137V28.5949C21.8272 28.7696 21.7187 28.881 21.5413 28.881H20.7001C20.5227 28.881 20.4141 28.7696 20.4141 28.5949V27.9137C20.4141 27.8245 20.4401 27.7534 20.4909 27.7045C20.5474 27.6512 20.6224 27.6222 20.7001 27.624V26.7968C20.7001 26.7221 20.7454 26.6538 20.843 26.6538H21.3976ZM21.5405 28.5949V27.9108H20.6993V28.5949H21.5405ZM21.2546 27.624V26.9405H20.986V27.6247L21.2546 27.624Z" fill="#3E3E3F"/>
            <path d="M25.6585 27.6729H24.6743C24.6366 27.6721 24.6005 27.6568 24.574 27.6301C24.5474 27.6035 24.5321 27.5676 24.5312 27.5299V26.7968C24.5312 26.7221 24.5944 26.6538 24.6743 26.6538H25.8014C25.8812 26.6538 25.9444 26.7228 25.9444 26.7968V28.7372C25.9444 28.8142 25.887 28.8802 25.8014 28.8802H25.6585C25.6396 28.8807 25.6208 28.8772 25.6032 28.8701C25.5858 28.8631 25.5698 28.8525 25.5565 28.8392C25.5431 28.8259 25.5326 28.8099 25.5255 28.7925C25.5184 28.7748 25.5152 28.7561 25.5155 28.7372C25.5145 28.7182 25.5176 28.6991 25.5245 28.6814C25.5313 28.6636 25.5418 28.6475 25.5553 28.6341C25.5688 28.6206 25.5849 28.6101 25.6027 28.6032C25.6205 28.5964 25.6394 28.5933 25.6585 28.5943V27.6729ZM25.6585 27.3869V26.9405H24.8171V27.3869H25.6585Z" fill="#3E3E3F"/>
            <path d="M27.5765 26.6538C27.6734 26.6538 27.7194 26.7228 27.7194 26.7968V27.624C27.8086 27.624 27.8767 27.6557 27.9286 27.7045C27.9802 27.7526 28.0061 27.8245 28.0061 27.9137V28.5949C28.0061 28.7696 27.8976 28.881 27.7202 28.881H26.8796C26.7022 28.881 26.5938 28.7696 26.5938 28.5949V27.9137C26.5938 27.8245 26.6196 27.7534 26.6706 27.7045C26.6984 27.678 26.7312 27.6573 26.7671 27.6435C26.8029 27.6296 26.8413 27.6231 26.8796 27.624V26.7968C26.8796 26.7221 26.9249 26.6538 27.0227 26.6538H27.5765ZM27.7187 28.5949V27.9108H26.8782V28.5949H27.7187ZM27.4335 27.624V26.9405H27.1642V27.6247L27.4335 27.624Z" fill="#3E3E3F"/>
            <path d="M28.9382 26.9413C28.9382 27.0039 28.8872 27.0844 28.7954 27.0844C28.704 27.0844 28.6523 27.0039 28.6523 26.9413V26.7983C28.6523 26.7358 28.704 26.6553 28.7954 26.6553H30.0661V27.4853C30.0661 27.5852 30.0689 27.5967 29.9893 27.6657L29.5884 28.0121C29.5136 28.0775 29.5087 28.0832 29.5087 28.1838V28.7386C29.5087 28.83 29.4685 28.8816 29.3657 28.8816C29.2623 28.8816 29.2228 28.83 29.2228 28.7386V28.0495C29.2228 27.9545 29.2256 27.946 29.2975 27.8834L29.6925 27.5429C29.7867 27.4594 29.7809 27.4631 29.7809 27.3365V26.9413H28.9382Z" fill="#3E3E3F"/>
            <path d="M30.9929 27.8683H31.9484C32.0914 27.8683 32.12 27.928 32.12 28.0602V28.7013C32.12 28.8357 32.0626 28.8816 31.934 28.8816H30.893C30.7581 28.8816 30.707 28.8328 30.707 28.7013V26.7983C30.707 26.733 30.7299 26.6553 30.8298 26.6553H31.0015C31.0762 26.6553 31.1359 26.7242 31.1359 26.7983C31.1368 26.8174 31.1338 26.8363 31.1269 26.8541C31.12 26.8719 31.1094 26.888 31.0961 26.9015C31.0826 26.915 31.0665 26.9254 31.0487 26.9323C31.0309 26.9392 31.0118 26.9421 30.9929 26.9413V27.8683ZM30.9929 28.1543V28.5949H31.8335V28.1543H30.9929Z" fill="#3E3E3F"/>
            <path d="M35.3932 27.624H35.9191C36.0102 27.624 36.0792 27.6384 36.1475 27.7045C36.2278 27.7793 36.2365 27.8476 36.2365 27.9475V28.5604C36.2365 28.6488 36.2278 28.7121 36.1676 28.7839C36.0971 28.8695 36.0224 28.881 35.9197 28.881H35.2846C35.21 28.881 35.1669 28.8609 35.0958 28.8292L34.9872 28.7811C34.9103 28.7465 34.8242 28.7207 34.8242 28.6208C34.8242 28.5461 34.8874 28.4778 34.9613 28.4778C34.9959 28.4778 35.0211 28.4865 35.0527 28.5008L35.1387 28.5382C35.1791 28.5555 35.2444 28.5956 35.2903 28.5956H35.9513V27.9108H35.1071V26.6538H36.0943C36.1691 26.6538 36.2372 26.6941 36.2372 26.7968C36.2372 26.9004 36.1682 26.9399 36.0943 26.9399H35.3932V27.624Z" fill="#3E3E3F"/>
            <path d="M37.8686 27.8676V27.0404C37.8686 26.9687 37.9029 26.8974 38.0114 26.8974C38.12 26.8974 38.1544 26.9693 38.1544 27.0404V27.8676C38.2292 27.8676 38.2975 27.908 38.2975 28.0107C38.2975 28.1134 38.2285 28.1537 38.1544 28.1537V28.7372C38.1544 28.8285 38.1143 28.8802 38.0114 28.8802C37.9087 28.8802 37.8686 28.8285 37.8686 28.7372V28.1537H37.0273V26.7968C37.0273 26.7249 37.0617 26.6538 37.1702 26.6538C37.2787 26.6538 37.3132 26.7257 37.3132 26.7968V27.8676H37.8686Z" fill="#3E3E3F"/>
            <path d="M39.0805 26.9404C39.0058 26.9404 38.9375 26.9002 38.9375 26.7974C38.9375 26.6947 39.0065 26.6543 39.0805 26.6543H40.0648C40.1024 26.6537 40.14 26.6604 40.175 26.6746C40.2101 26.6887 40.2419 26.7098 40.2687 26.7365C40.2953 26.7631 40.3164 26.7951 40.3304 26.8301C40.3446 26.8652 40.3515 26.9027 40.3506 26.9404V27.4903C40.3506 27.6045 40.3276 27.6878 40.2392 27.7676C40.3276 27.8481 40.3506 27.9307 40.3506 28.0449V28.5948C40.3515 28.6325 40.3446 28.67 40.3304 28.7051C40.3164 28.7402 40.2953 28.7721 40.2687 28.7987C40.2419 28.8256 40.2101 28.8465 40.175 28.8606C40.14 28.8748 40.1024 28.8815 40.0648 28.8809H39.0805C39.0058 28.8809 38.9375 28.8406 38.9375 28.7379C38.9375 28.635 39.0065 28.5948 39.0805 28.5948H40.0648V28.119C40.0648 27.9589 40.0016 27.91 39.9217 27.91H39.3615C39.2868 27.91 39.2185 27.8697 39.2185 27.767C39.2185 27.6641 39.2868 27.6239 39.3615 27.6239H39.9217C40.0016 27.6239 40.0648 27.5757 40.0648 27.4147V26.9404H39.0805Z" fill="#3E3E3F"/>
            <path d="M41.2898 28.5956H42.274C42.3487 28.5956 42.4171 28.6359 42.4171 28.7386C42.4171 28.8421 42.3481 28.8816 42.274 28.8816H41.0039V27.9489C41.0039 27.734 41.1124 27.6255 41.3272 27.6255H42.1312V26.9413H41.1469C41.0722 26.9413 41.0039 26.901 41.0039 26.7983C41.0039 26.6956 41.0729 26.6553 41.1469 26.6553H42.0966C42.1907 26.6553 42.2567 26.6696 42.3287 26.7358C42.4083 26.8105 42.4171 26.8873 42.4171 26.9902V27.5766C42.4171 27.6793 42.4083 27.757 42.3287 27.8309C42.2567 27.8964 42.1914 27.9107 42.0966 27.9107H41.2898V28.5956Z" fill="#3E3E3F"/>
            <path d="M41.6949 10.2072V8.77083H38.8221C38.8221 8.38981 38.6708 8.02442 38.4014 7.75516C38.132 7.48573 37.7666 7.33447 37.3857 7.33447H35.2311C34.8501 7.33447 34.4847 7.48573 34.2154 7.75516C33.946 8.02442 33.7947 8.38981 33.7947 8.77083H30.9219V10.2072H33.7947V11.6434H30.9219V13.0797H33.7947C33.7947 13.4607 33.946 13.8261 34.2154 14.0954C34.4847 14.3648 34.8501 14.5161 35.2311 14.5161H37.3857C37.7666 14.5161 38.132 14.3648 38.4014 14.0954C38.6708 13.8261 38.8221 13.4607 38.8221 13.0797H41.6949V11.6434H38.8221V10.2072H41.6949Z" fill="#FBE158"/>
            <path d="M3.15234 22.6602V22.6517C3.15234 21.8313 3.76658 21.1597 4.64005 21.1597C5.08542 21.1597 5.37773 21.2918 5.62922 21.4851C5.66016 21.5088 5.68518 21.5394 5.7023 21.5744C5.71958 21.6093 5.72847 21.6478 5.7283 21.6868C5.72847 21.7198 5.72188 21.7522 5.70937 21.7826C5.6967 21.8129 5.6781 21.8404 5.65457 21.8634C5.6312 21.8863 5.60338 21.9044 5.57293 21.9166C5.54232 21.9288 5.50973 21.9347 5.47698 21.9341C5.42201 21.935 5.36835 21.9176 5.32457 21.8843C5.12706 21.7235 4.91228 21.6251 4.63643 21.6251C4.08835 21.6251 3.68462 22.0784 3.68462 22.6429V22.6508C3.68462 23.2154 4.08473 23.6731 4.63643 23.6731C4.94174 23.6731 5.14714 23.5738 5.35765 23.3972C5.39962 23.36 5.45377 23.3395 5.50989 23.3398C5.63778 23.3398 5.7492 23.4468 5.7492 23.5747C5.74888 23.6091 5.7413 23.643 5.72715 23.6742C5.71283 23.7055 5.69226 23.7335 5.66658 23.7564C5.39436 23.9955 5.08542 24.1435 4.61915 24.1435C3.77876 24.1435 3.15234 23.4884 3.15234 22.6602Z" fill="#FCF6C2"/>
            <path d="M6.31643 21.465C6.31594 21.4314 6.32236 21.3978 6.33503 21.3667C6.3477 21.3354 6.36647 21.3071 6.39033 21.2833C6.4142 21.2595 6.44267 21.2408 6.47378 21.2283C6.50505 21.2156 6.53846 21.2093 6.5722 21.21H7.60235C7.9651 21.21 8.24951 21.317 8.43484 21.498C8.58725 21.6546 8.67415 21.8693 8.67415 22.1208V22.1287C8.67415 22.5906 8.4062 22.8707 8.01827 22.99L8.57062 23.6867C8.62016 23.7484 8.65325 23.8024 8.65325 23.8806C8.65209 23.944 8.62592 24.0042 8.58033 24.0483C8.53491 24.0923 8.47385 24.1165 8.41048 24.1155C8.36127 24.1163 8.31288 24.1044 8.26959 24.0814C8.22614 24.0582 8.18944 24.0245 8.16261 23.9833L7.46229 23.0891H6.82369V23.8641C6.82369 24.0042 6.71226 24.1155 6.5722 24.1155C6.53879 24.1161 6.50571 24.11 6.4746 24.0977C6.44366 24.0854 6.41551 24.0669 6.39165 24.0434C6.36778 24.02 6.34886 23.9922 6.33602 23.9614C6.32318 23.9306 6.31643 23.8976 6.31643 23.8641V21.465ZM7.56565 22.6394C7.9284 22.6394 8.15899 22.4498 8.15899 22.1574V22.1495C8.15899 21.8407 7.9363 21.6712 7.56137 21.6712H6.82369V22.6394H7.56565Z" fill="#FCF6C2"/>
            <path d="M9.30083 23.837V21.463C9.30034 21.4294 9.30659 21.3958 9.31943 21.3647C9.3321 21.3335 9.35086 21.3052 9.37473 21.2815C9.39859 21.2576 9.4269 21.2388 9.45818 21.2263C9.48945 21.2136 9.52286 21.2074 9.5566 21.2081H11.2339C11.294 21.2081 11.3514 21.2319 11.3939 21.2744C11.4364 21.3167 11.4602 21.3743 11.4602 21.4344C11.4602 21.4943 11.4364 21.5519 11.3939 21.5943C11.3514 21.6368 11.294 21.6605 11.2339 21.6605H9.80809V22.4105H11.0486C11.1092 22.4112 11.1671 22.4359 11.2095 22.4792C11.252 22.5223 11.2757 22.5805 11.2755 22.6411C11.2755 22.7646 11.1722 22.8638 11.0486 22.8638H9.80809V23.638H11.2548C11.3783 23.638 11.481 23.7415 11.481 23.865C11.4811 23.8948 11.4754 23.9242 11.464 23.9517C11.4526 23.9792 11.436 24.0042 11.415 24.0253C11.3939 24.0464 11.3689 24.063 11.3414 24.0743C11.3139 24.0857 11.2844 24.0915 11.2548 24.0913H9.5566C9.52286 24.0923 9.48928 24.0862 9.45801 24.0739C9.42674 24.0613 9.39826 24.0427 9.37423 24.0189C9.35037 23.9952 9.33161 23.9667 9.31893 23.9354C9.30626 23.9043 9.30017 23.8708 9.30083 23.837Z" fill="#FCF6C2"/>
            <path d="M12.0586 21.465C12.0581 21.4314 12.0644 21.3978 12.0771 21.3667C12.0897 21.3354 12.1087 21.3071 12.1325 21.2833C12.1564 21.2595 12.1847 21.2408 12.216 21.2283C12.2473 21.2156 12.2807 21.2093 12.3144 21.21H13.1347C14.0413 21.21 14.6677 21.832 14.6677 22.6444V22.6523C14.6677 23.464 14.0413 24.0947 13.1347 24.0947H12.3144C12.2807 24.0952 12.2471 24.0891 12.2158 24.0765C12.1846 24.0638 12.1561 24.045 12.1322 24.0212C12.1083 23.9973 12.0896 23.9688 12.0769 23.9376C12.0642 23.9063 12.058 23.8727 12.0586 23.839V21.465ZM13.1347 23.6329C13.7402 23.6329 14.1361 23.2249 14.1361 22.6602V22.6516C14.1361 22.0871 13.7402 21.6712 13.1347 21.6712H12.5657V23.6329H13.1347Z" fill="#FCF6C2"/>
            <path d="M15.3047 21.4408C15.3047 21.3007 15.416 21.1895 15.5595 21.1895C15.6994 21.1895 15.8106 21.3007 15.8106 21.4408V23.8643C15.8106 24.0044 15.6994 24.1158 15.5595 24.1158C15.5261 24.1165 15.493 24.1104 15.462 24.098C15.4309 24.0857 15.4028 24.0673 15.3791 24.0439C15.3554 24.0204 15.3365 23.9925 15.3238 23.9616C15.3109 23.9308 15.3045 23.8977 15.3047 23.8643V21.4408Z" fill="#FCF6C2"/>
            <path d="M17.2954 21.6802H16.5942C16.5319 21.6802 16.4721 21.6553 16.4282 21.6114C16.3841 21.5673 16.3594 21.5075 16.3594 21.4453C16.3594 21.3829 16.3841 21.3232 16.4282 21.2791C16.4721 21.2351 16.5319 21.2104 16.5942 21.2104H18.5107C18.6386 21.2104 18.7413 21.3174 18.7413 21.4453C18.7416 21.5069 18.7174 21.5661 18.6743 21.6101C18.6312 21.654 18.5724 21.6792 18.5107 21.6802H17.8061V23.8646C17.8061 24.0047 17.6912 24.1159 17.551 24.1159C17.5177 24.1162 17.4848 24.11 17.4539 24.0975C17.4231 24.085 17.3951 24.0665 17.3714 24.0432C17.3477 24.0198 17.3288 23.992 17.316 23.9614C17.303 23.9308 17.2962 23.8978 17.296 23.8646L17.2954 21.6802Z" fill="#FCF6C2"/>
            <path d="M20.3594 22.6602V22.6517C20.3594 21.8313 20.9736 21.1597 21.8471 21.1597C22.2925 21.1597 22.5848 21.2918 22.8363 21.4851C22.8672 21.5088 22.8922 21.5394 22.9093 21.5744C22.9266 21.6093 22.9355 21.6478 22.9353 21.6868C22.9355 21.7198 22.9289 21.7522 22.9164 21.7826C22.9037 21.8129 22.8851 21.8404 22.8616 21.8634C22.8382 21.8863 22.8104 21.9044 22.78 21.9166C22.7493 21.9288 22.7168 21.9347 22.684 21.9341C22.629 21.935 22.5754 21.9176 22.5316 21.8843C22.3341 21.7235 22.12 21.6251 21.8435 21.6251C21.2954 21.6251 20.8916 22.0784 20.8916 22.6429V22.6508C20.8916 23.2154 21.2918 23.6731 21.8435 23.6731C22.1488 23.6731 22.3542 23.5738 22.5647 23.3972C22.6068 23.36 22.661 23.3396 22.7169 23.3398C22.8448 23.3398 22.9562 23.4468 22.9562 23.5747C22.9559 23.6091 22.9483 23.643 22.9342 23.6742C22.9199 23.7055 22.8993 23.7335 22.8736 23.7564C22.6014 23.9955 22.2925 24.1435 21.8262 24.1435C20.9858 24.1435 20.3594 23.4884 20.3594 22.6602Z" fill="#FCF6C2"/>
            <path d="M23.3611 23.7647L24.4322 21.374C24.4903 21.2461 24.5932 21.168 24.7375 21.168H24.7619C24.9062 21.168 25.0054 21.2461 25.0629 21.374L26.1347 23.7647C26.1534 23.7973 26.1636 23.834 26.1641 23.8716C26.1648 23.9034 26.159 23.935 26.1474 23.9646C26.1357 23.9941 26.1181 24.0211 26.0958 24.0438C26.0735 24.0665 26.047 24.0845 26.0175 24.0968C25.9882 24.109 25.9568 24.1152 25.9248 24.1151C25.8048 24.1151 25.723 24.0448 25.6778 23.9376L25.4429 23.3983H24.0415L23.7985 23.9549C23.7812 24.003 23.7491 24.0443 23.707 24.0731C23.6649 24.1021 23.6147 24.1169 23.5637 24.1159C23.5223 24.1166 23.4815 24.106 23.4456 24.0856C23.4096 24.0652 23.3798 24.0356 23.3591 23.9999C23.3385 23.964 23.3278 23.9233 23.3281 23.8819C23.3285 23.8405 23.3398 23.8001 23.3611 23.7647ZM25.2482 22.9486L24.7411 21.782L24.2339 22.9486H25.2482Z" fill="#FCF6C2"/>
            <path d="M26.711 21.465C26.7105 21.4314 26.7167 21.3978 26.7294 21.3667C26.7422 21.3354 26.761 21.3071 26.7849 21.2833C26.8087 21.2595 26.837 21.2408 26.8683 21.2283C26.8996 21.2156 26.933 21.2093 26.9667 21.21H27.9969C28.3596 21.21 28.644 21.317 28.8294 21.498C28.9816 21.6546 29.0685 21.8693 29.0685 22.1208V22.1287C29.0685 22.5906 28.8006 22.8707 28.4128 22.99L28.9652 23.6867C29.0147 23.7484 29.0478 23.8024 29.0478 23.8806C29.0466 23.944 29.0205 24.0042 28.9749 24.0483C28.9294 24.0923 28.8682 24.1165 28.805 24.1155C28.7558 24.1163 28.7074 24.1044 28.664 24.0814C28.6207 24.0582 28.584 24.0245 28.5571 23.9833L27.8568 23.0891H27.2181V23.8641C27.2181 24.0042 27.1068 24.1155 26.9667 24.1155C26.9333 24.1161 26.9002 24.11 26.8691 24.0977C26.8382 24.0854 26.8099 24.0669 26.7862 24.0434C26.7623 24.02 26.7434 23.9922 26.7306 23.9614C26.7175 23.9306 26.711 23.8976 26.711 23.8641V21.465ZM27.9595 22.6394C28.3223 22.6394 28.5529 22.4498 28.5529 22.1574V22.1495C28.5529 21.8407 28.3302 21.6712 27.9551 21.6712H27.2174V22.6394H27.9595Z" fill="#FCF6C2"/>
            <path d="M29.6875 21.4654C29.687 21.4318 29.6933 21.3984 29.706 21.3673C29.7186 21.3361 29.7374 21.3077 29.7611 21.284C29.785 21.2602 29.8133 21.2414 29.8444 21.2289C29.8755 21.2162 29.9089 21.21 29.9425 21.2105H30.7629C31.6695 21.2105 32.2959 21.8325 32.2959 22.6449V22.6528C32.2959 23.4645 31.6695 24.0952 30.7629 24.0952H29.9425C29.9089 24.0957 29.8755 24.0893 29.8442 24.0766C29.8129 24.0639 29.7846 24.0452 29.7609 24.0213C29.7371 23.9974 29.7183 23.969 29.7058 23.9379C29.6931 23.9066 29.687 23.8732 29.6875 23.8394V21.4654ZM30.7629 23.6332C31.3691 23.6332 31.765 23.2252 31.765 22.6607V22.6521C31.765 22.0874 31.3691 21.6717 30.7629 21.6717H30.194V23.6332H30.7629Z" fill="#FCF6C2"/>
            </svg>',
        'revolut' => '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20.9148 6.957C20.9148 3.12 17.7918 0 13.9518 0H2.42578V3.86H13.4038C15.1418 3.86 16.5808 5.226 16.6128 6.904C16.6218 7.31655 16.5479 7.72672 16.3953 8.11014C16.2428 8.49356 16.0148 8.84242 15.7248 9.136C15.4368 9.43138 15.0925 9.66591 14.7122 9.82566C14.3318 9.98542 13.9233 10.0671 13.5108 10.066H9.23378C9.16093 10.0663 9.09113 10.0953 9.03962 10.1468C8.9881 10.1984 8.95904 10.2681 8.95878 10.341V13.772C8.95878 13.832 8.97611 13.886 9.01078 13.934L16.2668 24H21.5778L14.3048 13.906C17.9678 13.722 20.9148 10.646 20.9148 6.957ZM6.89578 5.923H2.42578V24H6.89578V5.923Z" fill="black"/>
            </svg>',
        'google-pay' => '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_3079_2221)">
            <path d="M8.35909 0.788944C5.96112 1.62082 3.89311 3.19976 2.45882 5.29382C1.02454 7.38789 0.299573 9.88671 0.390418 12.4233C0.481264 14.9598 1.38313 17.4004 2.96355 19.3864C4.54396 21.3725 6.71962 22.7995 9.17096 23.4577C11.1583 23.9705 13.2405 23.993 15.2385 23.5233C17.0484 23.1168 18.7218 22.2471 20.0947 20.9996C21.5236 19.6615 22.5608 17.9592 23.0947 16.0758C23.6751 14.0277 23.7783 11.8738 23.3966 9.77957H12.2366V14.4089H18.6997C18.5705 15.1473 18.2937 15.852 17.8859 16.4809C17.478 17.1098 16.9474 17.6499 16.326 18.0689C15.5367 18.591 14.6471 18.9423 13.7141 19.1002C12.7784 19.2742 11.8186 19.2742 10.8828 19.1002C9.93444 18.9041 9.03727 18.5127 8.24846 17.9508C6.98124 17.0538 6.02973 15.7794 5.52971 14.3096C5.02124 12.8122 5.02124 11.1888 5.52971 9.69144C5.88564 8.64185 6.47403 7.6862 7.25096 6.89582C8.14007 5.97472 9.26571 5.31631 10.5044 4.99284C11.7431 4.66936 13.0469 4.69331 14.2728 5.06207C15.2305 5.35605 16.1063 5.8697 16.8303 6.56207C17.5591 5.83707 18.2866 5.11019 19.0128 4.38144C19.3878 3.98957 19.7966 3.61644 20.166 3.21519C19.0608 2.18671 17.7635 1.38643 16.3485 0.860194C13.7717 -0.0754498 10.9522 -0.100594 8.35909 0.788944Z" fill="white"/>
            <path d="M8.35875 0.789855C10.9516 -0.100288 13.7711 -0.0758051 16.3481 0.85923C17.7634 1.38904 19.0601 2.19318 20.1638 3.22548C19.7888 3.62673 19.3931 4.00173 19.0106 4.39173C18.2831 5.11798 17.5562 5.84173 16.83 6.56298C16.106 5.87061 15.2302 5.35696 14.2725 5.06298C13.047 4.69293 11.7432 4.66759 10.5042 4.98975C9.26516 5.3119 8.13883 5.9691 7.24875 6.88923C6.47181 7.67961 5.88342 8.63526 5.5275 9.68486L1.64062 6.67548C3.03189 3.91653 5.44078 1.80615 8.35875 0.789855Z" fill="#E33629"/>
            <path d="M0.611401 9.65605C0.820316 8.62067 1.16716 7.61798 1.64265 6.6748L5.52953 9.69168C5.02105 11.1891 5.02105 12.8124 5.52953 14.3098C4.23453 15.3098 2.9389 16.3148 1.64265 17.3248C0.452308 14.9554 0.0892746 12.2557 0.611401 9.65605Z" fill="#F8BD00"/>
            <path d="M12.2391 9.77832H23.3991C23.7809 11.8726 23.6776 14.0264 23.0972 16.0746C22.5633 17.958 21.5261 19.6602 20.0972 20.9983C18.8429 20.0196 17.5829 19.0483 16.3285 18.0696C16.9504 17.6501 17.4812 17.1094 17.8891 16.4798C18.297 15.8503 18.5735 15.1448 18.7022 14.4058H12.2391C12.2372 12.8646 12.2391 11.3214 12.2391 9.77832Z" fill="#587DBD"/>
            <path d="M1.64062 17.3246C2.93688 16.3246 4.2325 15.3196 5.5275 14.3096C6.02851 15.7799 6.98138 17.0544 8.25 17.9508C9.04126 18.5101 9.94037 18.8983 10.89 19.0908C11.8257 19.2648 12.7855 19.2648 13.7213 19.0908C14.6542 18.9329 15.5439 18.5816 16.3331 18.0596C17.5875 19.0383 18.8475 20.0096 20.1019 20.9883C18.7292 22.2366 17.0558 23.1068 15.2456 23.5139C13.2476 23.9836 11.1655 23.9611 9.17813 23.4483C7.60632 23.0286 6.13814 22.2888 4.86563 21.2752C3.51874 20.2059 2.41867 18.8583 1.64062 17.3246Z" fill="#319F43"/>
            </g>
            <defs>
            <clipPath id="clip0_3079_2221">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
            </svg>
            ',
        'apple-pay' => '<svg width="24" height="28" viewBox="0 0 24 28" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19.9966 26.8766C18.4459 28.3542 16.7527 28.1209 15.1229 27.421C13.3981 26.7055 11.8157 26.6744 9.99598 27.421C7.71736 28.3853 6.51476 28.1053 5.15392 26.8766C-2.56807 19.0532 -1.42876 7.1391 7.3376 6.7036C9.4738 6.81247 10.9612 7.85456 12.2113 7.94789C14.0785 7.5746 15.8666 6.5014 17.8604 6.64138C20.2498 6.82803 22.0537 7.76124 23.2405 9.44103C18.3035 12.3496 19.4744 18.7421 24 20.5307C23.098 22.8638 21.9271 25.1813 19.9808 26.8922L19.9966 26.8766ZM12.0531 6.61028C11.8157 3.14183 14.6798 0.279965 17.9712 0C18.43 4.01283 14.2684 6.99912 12.0531 6.61028Z" fill="black"/>
            </svg>
            '
    );

    if (isset($svg_icons[$icon_name])) {
        // Define allowed HTML tags and attributes for SVG
        $kses_defaults = wp_kses_allowed_html('post');

        $svg_args = array(
            'svg' => array(
                'width' => true,
                'height' => true,
                'xmlns' => true,
                'viewbox' => true,
                'fill' => true,
                'class' => true,
            ),
            'path' => array(
                'd' => true,
                'fill' => true,
                'stroke' => true,
                'stroke-width' => true,
                'stroke-linecap' => true,
                'stroke-linejoin' => true,
            ),
        );

        $allowed_tags = array_merge($kses_defaults, $svg_args);

        return sprintf(
            '<div class="lapinopay-payment-icon" role="img" aria-label="%s">%s</div>',
            esc_attr($alt_text),
            wp_kses($svg_icons[$icon_name], $allowed_tags)
        );
    }

    // Fallback if icon not found
    return sprintf(
        '<span class="lapinopay-payment-icon" aria-label="%s"></span>',
        esc_attr($alt_text)
    );
}
?>
<style>
    #add_payment_method #payment div.payment_box::before,
    .woocommerce-cart #payment div.payment_box::before,
    .woocommerce-checkout #payment div.payment_box::before {
        display: none !important;
    }

    .payment_box.payment_method_lapinopay-instant-payment-gateway-guardarian {
        background-color: transparent !important;
        padding: 0 !important;
        border: none !important;
        margin: 0 !important;
    }

    .form-row.place-order {
        display: none !important;
        padding: 0 !important;
    }

    .woocommerce-terms-and-conditions-wrapper {
        padding: 0 !important;
        background: transparent !important;
        display: none !important;
    }

    .lapinopay-additional-fields {
        display: none !important;
    }

    #payment .payment_methods>li>label,
    #payment .payment_methods>li {
        background: transparent !important;
        padding: 0 !important;
        margin: 0 !important;
    }

    .lapinopay-additional-fields select {
        display: none !important;
    }

    #payment .payment_methods>li:first-child {
        border-top: none !important;
    }

    .lapinopay-payment-container {
        background: #ffffff;
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        max-width: 100%;
        margin: 0;
    }

    /* Add styles for payment icons */
    .lapinopay-payment-icon {
        display: flex;
        align-items: center;
        /* justify-content: center;
        width: 24px;
        height: 24px; */
        color: #1a1a1a;
    }

    .lapinopay-payment-icon svg {
        width: 100%;
        height: 100%;
    }

    /* Specific icon colors */
    .lapinopay-payment-method[data-method="google-pay"] .lapinopay-payment-icon {
        color: #4285f4;
    }

    .lapinopay-payment-method[data-method="apple-pay"] .lapinopay-payment-icon {
        color: #000000;
    }

    .lapinopay-payment-method[data-method="revolut"] .lapinopay-payment-icon {
        color: #0666eb;
    }

    .lapinopay-security-badge {
        display: none;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        /* background: #f8f9fa; */
        border-radius: 20px;
        color: #1a1a1a;
        font-size: 14px;
        font-weight: 500;
        margin-bottom: 24px;
        width: 98%;
    }

    .lapinopay-security-badge img {
        width: 46px;
        /* height: 16px; */
    }

    .lapinopay-payment-methods {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .lapinopay-payment-method {
        position: relative;
        border: 1px solid #e9ecef;
        border-radius: 12px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.2s ease;
        background: #ffffff;
    }

    .lapinopay-payment-method:hover {
        background: #f8f9fa;
        border-color: #000;
    }

    .lapinopay-payment-method.selected {
        border-color: #000;
        background: #f8f9fa;
    }

    .lapinopay-payment-method input[type="radio"] {
        position: absolute;
        opacity: 0;
        cursor: pointer;
        height: 0;
        width: 0;
    }

    .lapinopay-payment-method label {
        display: flex;
        align-items: center;
        gap: 16px;
        margin: 0;
        cursor: pointer;
        flex-direction: row-reverse;
    }

    .lapinopay-payment-method-icon {
        width: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .lapinopay-payment-method-icon img {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    .lapinopay-payment-method-info {
        flex-grow: 1;
    }

    .lapinopay-payment-method-name {
        font-weight: 500;
        color: #1a1a1a;
        font-size: 16px;
        margin-bottom: 4px;
    }

    .lapinopay-payment-method-description {
        font-size: 14px;
        color: #6c757d;
    }

    .lapinopay-radio-check {
        width: 20px;
        height: 20px;
        border: 2px solid #dee2e6;
        border-radius: 50%;
        position: relative;
        transition: all 0.2s ease;
    }

    .lapinopay-payment-method.selected .lapinopay-radio-check {
        border-color: #000;
    }

    .lapinopay-payment-method.selected .lapinopay-radio-check:after {
        content: '';
        position: absolute;
        width: 10px;
        height: 10px;
        background: #000;
        border-radius: 50%;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .lapinopay-footer {
        margin-top: 24px;
        font-size: 14px;
        color: #6c757d;
        line-height: 1.5;
    }

    .lapinopay-footer a {
        color: #000;
        text-decoration: underline;
    }

    #place_order {
        display: none !important;
    }

    .lapinopay-place-order {
        width: 100%;
        padding: 16px 24px;
        background: #000000;
        color: #ffffff;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        margin-top: 24px;
        text-align: center;
        text-decoration: none;
        display: block;
    }

    .lapinopay-place-order:hover {
        background: #333333;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .lapinopay-place-order:active {
        transform: translateY(0);
    }

    .lapinopay-place-order:disabled {
        background: #cccccc;
        cursor: not-allowed;
    }
</style>

<!-- Hidden select for form submission -->
<select name="lapinopay_payment_category" id="lapinopay_payment_category" class="select" style="display: none;"
    required>
    <option value="">Select a payment method</option>
    <option value="VISA_MC">Credit Card</option>
    <option value="REVOLUT_PAY">Revolut Pay</option>
    <option value="GOOGLE_PAY">Google Pay</option>
    <option value="APPLE_PAY">Apple Pay</option>
</select>

<div class="lapinopay-payment-container">
    <div class="lapinopay-security-badge">
        <?php echo wp_kses_post(lapinopay_get_payment_icon('shield-check', 'Security')); ?>
        <!-- <span>Secure Payment</span> -->
    </div>

    <div class="lapinopay-payment-methods">
        <div class="lapinopay-payment-method selected" data-method="credit-card">
            <input type="radio" name="lapinopay_payment_method" id="credit-card" value="credit-card" checked>
            <label for="credit-card">
                <div class="lapinopay-payment-method-icon">
                    <?php echo wp_kses_post(lapinopay_get_payment_icon('credit-card', 'Credit Card')); ?>
                </div>
                <div class="lapinopay-payment-method-info">
                    <div class="lapinopay-payment-method-name">Credit Card</div>
                    <div class="lapinopay-payment-method-description">Pay securely with your credit card</div>
                </div>
                <span class="lapinopay-radio-check"></span>
            </label>
        </div>

        <div class="lapinopay-payment-method" data-method="revolut">
            <input type="radio" name="lapinopay_payment_method" id="revolut" value="revolut">
            <label for="revolut">
                <div class="lapinopay-payment-method-icon">
                    <?php echo wp_kses_post(lapinopay_get_payment_icon('revolut', 'Revolut')); ?>
                </div>
                <div class="lapinopay-payment-method-info">
                    <div class="lapinopay-payment-method-name">Revolut Pay</div>
                    <div class="lapinopay-payment-method-description">Fast and secure payment with Revolut</div>
                </div>
                <span class="lapinopay-radio-check"></span>
            </label>
        </div>

        <div class="lapinopay-payment-method" data-method="apple-pay">
            <input type="radio" name="lapinopay_payment_method" id="apple-pay" value="apple-pay">
            <label for="apple-pay">
                <div class="lapinopay-payment-method-icon">
                    <?php echo wp_kses_post(lapinopay_get_payment_icon('apple-pay', 'Apple Pay')); ?>
                </div>
                <div class="lapinopay-payment-method-info">
                    <div class="lapinopay-payment-method-name">Apple Pay</div>
                    <div class="lapinopay-payment-method-description">Quick checkout with Apple Pay</div>
                </div>
                <span class="lapinopay-radio-check"></span>
            </label>
        </div>

        <div class="lapinopay-payment-method" data-method="google-pay">
            <input type="radio" name="lapinopay_payment_method" id="google-pay" value="google-pay">
            <label for="google-pay">
                <div class="lapinopay-payment-method-icon">
                    <?php echo wp_kses_post(lapinopay_get_payment_icon('google-pay', 'Google Pay')); ?>
                </div>
                <div class="lapinopay-payment-method-info">
                    <div class="lapinopay-payment-method-name">Google Pay</div>
                    <div class="lapinopay-payment-method-description">Easy payment with Google Pay</div>
                </div>
                <span class="lapinopay-radio-check"></span>
            </label>
        </div>
    </div>

    <div class="lapinopay-footer">
        Your personal data will be used to process your order, support your experience throughout this website, and for
        other purposes described in our <a target="_blank" href="https://www.lapinopay.com/privacy">Privacy
            policy</a>.
    </div>

    <button type="submit" class="lapinopay-place-order" id="lapinopay-place-order">
        Place order
    </button>
</div>

<script>
    jQuery(function ($) {
        // Get the hidden select element - Fix the selector to make sure we get the right element
        const payment_field_category = $('#lapinopay_payment_category');

        const paymentCategories = {
            'credit-card': 'VISA_MC',
            'revolut': 'REVOLUT_PAY',
            'google-pay': 'GOOGLE_PAY',
            'apple-pay': 'APPLE_PAY'
        };

        function updatePaymentCategory(selectedValue) {
            // Log for debugging
            console.log('Updating payment category to:', paymentCategories[selectedValue]);

            // Make sure we have the select element
            if (payment_field_category.length) {
                // Update the value and trigger change event
                payment_field_category.val(paymentCategories[selectedValue]).trigger('change');
            } else {
                console.error('Payment category select element not found');
            }
        }

        // Handle click on payment method container
        $(document).on('click', '.lapinopay-payment-method', function (e) {
            e.preventDefault();

            const radio = $(this).find('input[type="radio"]');
            if (radio.length) {
                // Update UI
                $('.lapinopay-payment-method').removeClass('selected');
                $(this).addClass('selected');

                // Update radio buttons
                $('.lapinopay-payment-method input[type="radio"]').prop('checked', false);
                radio.prop('checked', true);

                // Update hidden select
                updatePaymentCategory(radio.val());
            }
        });

        // Set initial value based on default selected radio
        const defaultSelected = $('.lapinopay-payment-method input[type="radio"]:checked');
        if (defaultSelected.length) {
            updatePaymentCategory(defaultSelected.val());
        }

        // Handle WooCommerce checkout updates
        $(document.body).on('updated_checkout', function () {
            console.log('Checkout updated, re-checking payment methods');
            const selectedRadio = $('.lapinopay-payment-method input[type="radio"]:checked');
            if (selectedRadio.length) {
                updatePaymentCategory(selectedRadio.val());
            }
        });

        // Add click handler for the place order button
        $('#lapinopay-place-order').on('click', function (e) {
            e.preventDefault();
            // Trigger the original place order button
            $('#place_order').trigger('click');
        });
    });
</script>